branches:
  only:
  - master
  - release
env:
  global:
before_install:
- openssl aes-256-cbc -k "${DEPLOY_PASSPHRASE}" -in etc/gpg.enc -out etc/gpg -d
- openssl aes-256-cbc -k "${DEPLOY_PASSPHRASE}" -in etc/deploy.enc -out etc/deploy
  -d
- openssl aes-256-cbc -k "${DEPLOY_PASSPHRASE}" -in etc/deploy_apidocs.enc -out etc/deploy_apidocs
  -d
- gpg --import etc/gpg
- eval "$(ssh-agent)"
- chmod 600 etc/deploy etc/deploy_apidocs
- ssh-add etc/deploy
- ssh-add etc/deploy_apidocs
- git config --global user.name "Build Bot"
- git config --global user.email "buildbot@btrplace.org"
- git remote add deploy git@github.com:btrplace/scheduler.git
- export MAVEN_OPTS=-Xmx512m
install:
- mvn -Dgpg.passphrase=${GPG_PASSPHRASE} -q install -DskipTests
jdk:
- oraclejdk8
language: java
notifications:
  email:
    on_failure: always
    on_success: always
    recipients:
    - btrplace-ci@googlegroups.com
script: ./bin/build.sh
